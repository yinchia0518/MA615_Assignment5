---
title: "Assignment5_Part1"
output:
  ioslides_presentation: default
  beamer_presentation: default
fontsize: 10pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(ggplot2)
```

## Team members|Group 6

- Yue Wu 
- YinChia Huang 
- Francesco Ignazio Re

## Outline

- Introduction
- A time series composed of 30 years of daily
- Statistic Analysis
- Time Series & Analysis
- Conclusion

## Introduction
The purpose of this project is for us to exercise, extend, and demonstrate our abilities to use the ideas and tools of the Tidyverse. We are assigned data from NOAA Weather Station buoy 46035 at 57.026 N 177.738 W in the NOAA National
Data Buoy Center. Our goal is to obtain data, clean, organize, and explore it. 
We only focused on Air Temperature and Sea Temperature from 1988 to 2017. However, data of 2012 and 2013 are missing, which we replaced by the data of  nearby buoy 46070, assuming their temperatures should be pretty close.

```{r include=FALSE}
library(tidyverse)
library(stringr)
library("reshape2")
library("ggplot2")


url1 <- "http://www.ndbc.noaa.gov/view_text_file.php?filename=46035h"
url2 <- "http://www.ndbc.noaa.gov/view_text_file.php?filename=46070h"
url3 <- ".txt.gz&dir=data/historical/stdmet/"
years <- c(1988:2017)
urls1 <- str_c(url1, years, url3, sep = "")
urls2 <- str_c(url2, years, url3, sep = "")
filenames <- str_c("mr", years, sep = "")
N <- length(years)

#create files for each year 
i<-1
while (i <= N){
  
  if(i==25|i==26){
    suppressMessages(
      assign(filenames[i], read_table(urls2[i], col_names = TRUE)))
  }
  else{
    suppressMessages(
      assign(filenames[i], read_table(urls1[i], col_names = TRUE)))
  }
  file <- get(filenames[i])
  
  #add 19 in front of 2 digits year(from 1988 to 1998)
  colnames(file)[1] <-"YYYY"
  if(i>=1 && i<=11){
    file$YYYY<-paste("19", file$YYYY, sep = "")
  }
  #only select time, air temp and water temp
  file <- subset(file, select=c("YYYY", "MM","DD","hh","ATMP","WTMP"))
  file$ATMP<-as.numeric(file$ATMP)
  file$WTMP<-as.numeric(file$WTMP)
  file <- subset(file, ATMP!= 999.0 & ATMP!= 99.0)
  file <- subset(file, WTMP!= 999.0 & WTMP!= 99.0)
  annualMean_AT <- mean(file$ATMP, na.rm=TRUE)
  annualMean_WT <- mean(file$WTMP, na.rm=TRUE)
  
  if(i==1){
    MR <- file
    MR_DailyNoon <- subset(file, hh==12)
    annualMeans_AT <- annualMean_AT
    annualMeans_WT <- annualMean_WT
  }
  else{
    MR <- rbind.data.frame(MR, file)
    MR_DailyNoon <- rbind.data.frame(MR_DailyNoon, subset(file, hh==12))
    annualMeans_AT <- rbind.data.frame(annualMeans_AT, annualMean_AT)
    annualMeans_WT <- rbind.data.frame(annualMeans_WT, annualMean_WT)
  }
  i<-i+1
}
MR$FullTime <-strptime(with(MR, paste(YYYY, MM, DD, hh, sep="-")), format="%Y-%m-%d-%H")
MR_DailyNoon$FullTime <-strptime(with(MR_DailyNoon, paste(YYYY, MM, DD, hh, sep="-")), format="%Y-%m-%d-%H")

```


##A time series composed of 30 years of daily
```{r echo=FALSE}
ggplot(MR_DailyNoon, aes(x = FullTime)) + 
  geom_line(aes(y = ATMP, colour ="Air Temperature")) + 
  geom_line(aes(y = WTMP, colour = "Water Temperature")) +
  scale_colour_manual("", 
                      breaks = c("Air Temperature", "Water Temperature"),
                      values = c("pink", "blue"))+
  xlab("Time") +
  scale_y_continuous("Temperatura (C)", limits = c(0,10)) + 
  labs(title="A time series composed of 30 years of daily")
  
```

 
